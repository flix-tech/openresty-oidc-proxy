#user  nobody;
worker_processes  1;

#error_log  logs/error.log;
#error_log  logs/error.log  notice;
#error_log  logs/error.log  info;

#pid        logs/nginx.pid;

env OID_SESSION_SECRET;
env OID_SESSION_CHECK_SSI;
env OID_SESSION_NAME;
env OID_DISCOVERY;
env OID_CLIENT_ID;
env OID_CLIENT_SECRET;
env OID_REDIRECT_PATH;
env PROXY_HOST;
env PROXY_PORT;
env PROXY_PROTOCOL;
env OID_SESSION_USER;
env OID_SESSION_ENC_ID_TOKEN;
env OID_SESSION_REFRESH_TOKEN;
env OID_SESSION_WHITELIST_VARS;

events {
    worker_connections  1024;
}


http {
    #lua_code_cache off;
    include       mime.types;
    default_type  application/octet-stream;


    sendfile        on;
    #tcp_nopush     on;

    #keepalive_timeout  0;
    keepalive_timeout  65;

    include sites/*;

    lua_shared_dict discovery 10m;

    lua_ssl_trusted_certificate /etc/ssl/certs/ca-certificates.crt;
    lua_ssl_verify_depth 5;

    resolver 8.8.8.8;
}
